## 类加载流程

1. 加载(Loading)

   虚拟机规范中，对什么时候进行加载，并没有强制约束。

   加载阶段需要完成的事情：

   1. 通过一个类的全限定名来获取定义此类的二进制字节流
   2. 将这个字节流所代表的静态存储结构转化为方法区的运行时数据结构
   3. 在内存中生产一个代表这个类的java.lan.Class对象，作为方法区这个类的各种数据的访问入口

2. 验证(Verification)

   大致要完成4个阶段的验证动作：

   1. 文件格式验证

      对加载进来的字节流进行文件格式上面的验证，例如，魔数是否正确，大小版本是否支持，各个索引是否有不合理的指向。这个阶段的验证，本质上就是验证字节流里面的内容，是否能够正常的被加载到方法区当中。这个验证如果通过，对应的内容就回被加载到方法区，后面的验证都会基于方法区里的数据而非字节流。

   2. 元数据验证

      对字节码的信息进行语义上面的校验，例如是否存在父类、这个类的是否继承了不允许继承的父类等。

   3. 字节码验证

      这个阶段，主要是对方法体进行数据流和控制流分析，验证程序的逻辑是否正常、是否有不安全操作。

   4. 符号引用验证

      符号引用验证是发生在解析之前，是保证符号引用能够正确的转换称为直接引用。

3. 准备(Preparation)

   

4. 解析(Resolution)

5. 初始化(Initialization)

   虚拟机规范中规定了有且仅有这六种情况会触发初始化。这六种情况，被称为主动引用，其余的引用叫被动引用。

6. 使用(Using)

7. 卸载(Unloading)